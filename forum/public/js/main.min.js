var mainJs=function(){return{init:function(){mainJs.toggleMobileTopicMenu(),mainJs.urLive(),mainJs.togglePost(),mainJs.toggleView(),mainJs.toggleTopics(),mainJs.reply(),mainJs.sendPhotos(),mainJs.popOver(),mainJs.modalFileUpload(),mainJs.datePicker(),mainJs.mediaEdit(),mainJs.box(".files.grid .media .pads"),mainJs.toggleTheme(),mainJs.centerColorPicker(),mainJs.toggleLogo(),mainJs.fitPageHeight(),mainJs.dropdownTextChange(),mainJs.notify(),jQuery(document).ready(function(){jQuery(".generic-overlay").fadeOut("fast")}),jQuery(document).ready(function(){jQuery("#createTopicGroup .topic-selector tbody").on("click","tr",function(){var e=jQuery(this).parents(".column:eq(0)").hasClass("list"),i="";i=e?".selected":".list",jQuery(this).remove(),jQuery(this).clone().appendTo("#createTopicGroup .topic-selector "+i+" table tbody")})}),jQuery(".sortable").sortable()},toggleMobileTopicMenu:function(){jQuery('[data-toggle="offcanvas"]').click(function(){jQuery(".row-offcanvas").toggleClass("active")})},urLive:function(){jQuery("textarea.share-url").on("input propertychange",function(){jQuery(this).urlive({container:".share-url-container",callbacks:{onStart:function(){jQuery(".input-post .fa-circle-o-notch").show(),jQuery(".share-url-container").urlive("remove")},onSuccess:function(){jQuery(".input-post .fa-circle-o-notch").hide(),jQuery(".share-url-container").urlive("remove")},noData:function(){jQuery(".input-post .fa-circle-o-notch").hide(),jQuery(".share-url-container").urlive("remove")}}})}),jQuery(".share-link").each(function(e){var i=jQuery(this).parents(".media-body:eq(0)").find(".share-link-container").attr("class");jQuery(this).parents(".media-body:eq(0)").find(".share-link-container").addClass("index"+e),jQuery(this).urlive({container:"."+i+".index"+e,imageSize:"small"})})},liveUrl:function(){var e=new Array;$("textarea.share-url").liveUrl({loadStart:function(){jQuery(".input-post .circle-o-notch").show()},loadEnd:function(){jQuery(".input-post .circle-o-notch").hide()},success:function(i){var t=$(".liveurl");if(t.find(".title").text(i.title),t.find(".description").text(i.description),t.find(".url").text(i.url),t.find(".image").empty(),t.find(".close").one("click",function(){var i=$(this).parent();i.hide("fast"),i.find(".video").html("").hide(),i.find(".image").html(""),i.find(".controls .prev").addClass("inactive"),i.find(".controls .next").addClass("inactive"),i.find(".thumbnail").hide(),i.find(".image").hide(),$("textarea").trigger("clear"),e=new Array}),t.show("fast"),null!=i.video){var n=i.video.width/350;i.video.width=350,i.video.height=i.video.height/n;var r='<object width="'+i.video.width+'" height="'+i.video.height+'"><param name="movie"value="'+i.video.file+'"></param><param name="allowScriptAccess" value="always"></param><embed src="'+i.video.file+'"type="application/x-shockwave-flash"allowscriptaccess="always"width="'+i.video.width+'" height="'+i.video.height+'"></embed></object>';t.find(".video").html(r).show()}},addImage:function(i){var t=$(".liveurl"),n=$(i);return n.attr("alt","Preview"),i.width/i.height>7||i.height/i.width>4?!1:(e.push(n.attr("src")),t.find(".image").append(n),1==e.length&&(t.find(".thumbnail .current").text("1"),t.find(".thumbnail").show(),t.find(".image").show(),n.addClass("active"),jQuery(".thumbnail").hide()),2==e.length&&(t.find(".controls .next").removeClass("inactive"),jQuery(".thumbnail").show()),t.find(".thumbnail .max").text(e.length),void 0)}}),$(".liveurl ").on("click",".controls .button",function(){var e=$(this),i=$(this).parents(".liveurl"),t=i.find(".image"),n=$("img",t),r=$("img.active",t);if(e.hasClass("next"))var a=r.next("img");else var a=r.prev("img");if(a.length>0&&(r.removeClass("active"),a.addClass("active"),i.find(".thumbnail .current").text(a.index()+1),(a.index()+1==n.length||a.index()+1==1)&&e.addClass("inactive")),e.hasClass("next"))var o=a.prev("img");else var o=a.next("img");o.length>0?e.hasClass("next")?e.prev().removeClass("inactive"):e.next().removeClass("inactive"):e.hasClass("next")?e.prev().addClass("inactive"):e.next().addClass("inactive")})},togglePost:function(){jQuery(".share-url").on("focus",function(){jQuery(this).css("height","100px"),jQuery(".input-post .btn-post").fadeIn()}).on("blur",function(){jQuery(this).css("height","35px"),jQuery(".input-post .btn-post").fadeOut()})},toggleView:function(){jQuery(".view .btn").on("click",function(){jQuery(this).parent().find(".btn").removeClass("active"),jQuery(this).addClass("active"),jQuery(this).hasClass("grid")?jQuery(".files").addClass("grid"):jQuery(".files").removeClass("grid")})},toggleTopics:function(){jQuery(".panel-1>ul:not('.not')>li>a").on("click",function(e){e.preventDefault(),jQuery(this).find("i").toggleClass("fa fa-minus-circle fa fa-plus-circle"),jQuery(this).parent().find(">ul").toggle()})},reply:function(){jQuery(".controls .btn-reply").on("click",function(e){e.preventDefault(),jQuery(this).closest(".media-body").find(".reply-box").show(),jQuery(this).closest(".media-body").find(".reply-box textarea").focus()})},sendPhotos:function(){jQuery(".reply-box .btn-photo").on("click",function(){jQuery(this).parent().find(":file").trigger("click")})},popOver:function(){jQuery(".grid-info").popover({html:!0,title:function(){var e=jQuery.trim(jQuery(this).parent().find(".title").text());return e},template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:function(){var e=jQuery(this).parent().find("span.list-info").clone();return e.html()}})},modalFileUpload:function(){jQuery(".file-upload").dropzone({url:"/uploads"})},datePicker:function(){$(".calEvStart, .calEvEnd").datetimepicker({mask:!0})},mediaEdit:function(){jQuery(".media-edit").on("click",function(e){e.preventDefault();var i=jQuery(this).parents(".media-body").find(".editable:eq(0)"),t=jQuery.trim(i.text());i.parent().find("input[type='hidden']").remove(),i.before("<input type='hidden' value='"+t+"'>"),i.text(""),i.append("<textarea class='form-control' rows='2'>"+t+"</textarea>"),i.parent().find(".mode-edit").show()}),jQuery(".mode-edit .save").on("click",function(e){e.preventDefault();var i=jQuery(this).parent().prev().find("textarea").val();jQuery(this).parent().hide(),jQuery(this).parent().prev().text(i)}),jQuery(".mode-edit .cancel").on("click",function(e){e.preventDefault();var i=jQuery(this).parents(".post-content:eq(0)").find("input[type='hidden']").val();jQuery(this).parent().hide(),jQuery(this).parent().prev().text(i)})},box:function(e){jQuery(window).on("load resize click",function(){mainJs.boxReset(".files.grid .media .pads"),jQuery(e).height(mainJs.getMaxH(jQuery(e)))})},boxReset:function(e){jQuery(e).height("")},toggleTheme:function(){jQuery("link#theme").attr("href","/public/css/theme/"+jQuery.cookie("theme")+".min.css"),jQuery(".color-theme-picker ul li").each(function(){jQuery(this).find("a").attr("id")==jQuery.cookie("theme")&&jQuery(this).addClass("active")}),jQuery(".color-theme-picker ul li a").on("click",function(e){e.preventDefault(),jQuery.cookie("theme",this.id,{path:"/"});var i=this.id;i?jQuery("link#theme").attr("href","/public/css/theme/"+i+".min.css"):jQuery("link#theme").attr("href",""),jQuery(this).parents("ul:eq(0)").find("li").removeClass("active"),jQuery(this).parent().addClass("active"),mainJs.toggleLogo()})},centerColorPicker:function(){jQuery(".color-theme-picker").on("click","> i",function(){var e=jQuery(this).parent();e.addClass("active"),jQuery(".generic-overlay").fadeIn().click(function(){jQuery(this).hide(),e.removeClass("active").removeAttr("style")});var i=e.outerWidth()/2,t=e.outerHeight()/2;e.css({marginRight:-i+"px",marginBottom:-t+"px"})}).find("> a").click(function(e){e.stopPropagation(),jQuery(this).parent().removeClass("active").removeAttr("style"),jQuery(".generic-overlay").hide()})},getMaxH:function(e){var i=new Array;return e.each(function(e){i[e]=jQuery(this).height()}),Math.max.apply(Math,i)},scrollDirection:function(){var e=0;jQuery(window).scroll(function(){var i=jQuery(this).scrollTop();i>e?jQuery(".generic-overlay").is(":hidden")&&jQuery(".color-theme-picker").show():jQuery(".generic-overlay").is(":hidden")&&jQuery(".color-theme-picker").hide(),e=i})},toggleLogo:function(){jQuery.cookie("theme")&&"whitecliffe"==jQuery.cookie("theme")?jQuery(".app-logo img, .app-logo-mob img").attr("src","/public/img/logo/whitecliffe.png"):jQuery(".app-logo img, .app-logo-mob img").attr("src","/public/img/logo/bc.png")},fitPageHeight:function(){jQuery(window).on("load resize",function(){var e=mainJs.isVisible(jQuery(".toolbar"))+mainJs.isVisible(jQuery(".logo-wrap"))+mainJs.isVisible(jQuery(".navbar[role='navigation']")),i=jQuery("footer").outerHeight(!0),t=jQuery(window).height(),n=t-(e+i);jQuery(".row-offcanvas > .container").css("min-height",n+"px")})},isVisible:function(e){return e&&e.is(":visible")?e.outerHeight(!0):0},like:function(e,i){i.preventDefault(),jQuery(e).hasClass("fa-caret-up")?(jQuery(e).parent().find("small").attr("class","fa fa-heart"),jQuery(e).parent().find("a").css("pointer-events","auto"),e.style.pointerEvents="none"):(jQuery(e).parent().find("small").attr("class","fa fa-heart-o"),jQuery(e).parent().find("a").css("pointer-events","auto"),e.style.pointerEvents="none")},dropdownTextChange:function(){jQuery(".nav-contacts ul.dropdown-menu li a").on("click",function(){var e=jQuery.trim(jQuery(this).text());jQuery(this).parents(".dropdown:eq(0)").find(".dropdown-toggle span.text").text(e)})},notify:function(){$(".icon-notification.active .animated").toggleClass("swing"),setTimeout(function(){mainJs.notify()},500)},nocomma:null}}();jQuery(mainJs.init);